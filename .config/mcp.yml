# MCP Server Infrastructure Configuration
# Consolidated configuration for all Model Context Protocol servers
# This file defines the complete MCP cluster with 6 servers across 3 tiers

version: '1.0'

# ==============================================================================
# TIER 1: GitHub Integration (Primary MCP Service)
# ==============================================================================
servers:
  github:
    service:
      name: github-mcp
      type: mcp-server
      version: v0.20.1
      language: go
      source: https://github.com/github/github-mcp-server
    
    network:
      ip: 172.20.0.10
      port: 3000
    
    resources:
      cpu: 2
      memory: 1g
    
    volumes:
      - github-mcp-cache:/cache/github
      - github-mcp-data:/app/data
    
    capabilities:
      - repos
      - issues
      - pull_requests
      - actions
      - users
      - code_security
      - discussions
      - projects

  # ===========================================================================
  # TIER 2: Local Development MCP Services
  # ===========================================================================
  filesystem:
    service:
      name: filesystem-mcp
      type: mcp-server
      version: latest
      language: node
      source: https://github.com/modelcontextprotocol/servers
    
    network:
      ip: 172.20.0.30
    
    resources:
      cpu: 1
      memory: 2g
    
    volumes:
      - filesystem-node-cache:/cache/node
      - workspace:/workspace:ro
    
    capabilities:
      - read_file
      - write_file
      - list_directory
      - search_files

  memory:
    service:
      name: memory-mcp
      type: mcp-server
      version: latest
      language: node
      source: https://github.com/modelcontextprotocol/servers
    
    network:
      ip: 172.20.0.33
    
    resources:
      cpu: 1
      memory: 4g
    
    volumes:
      - memory-data:/memory
      - memory-node-cache:/cache/node
      - memory-cache:/cache/memory
    
    optimization:
      nvme: true
    
    capabilities:
      - knowledge_graph
      - entity_storage
      - relationship_mapping

  git:
    service:
      name: git-mcp
      type: mcp-server
      version: latest
      language: python
      source: https://github.com/modelcontextprotocol/servers
    
    network:
      ip: 172.20.0.34
    
    resources:
      cpu: 1
      memory: 1g
    
    volumes:
      - git-cache:/cache/git
      - git-pip-cache:/cache/pip
      - git-python-cache:/cache/python
    
    features:
      - git-lfs
      - libgit2
    
    capabilities:
      - git_log
      - git_diff
      - git_commit
      - git_status

  fetch:
    service:
      name: fetch-mcp
      type: mcp-server
      version: latest
      language: python
      source: https://github.com/modelcontextprotocol/servers
    
    network:
      ip: 172.20.0.35
    
    resources:
      cpu: 1
      memory: 1g
    
    volumes:
      - fetch-cache:/cache/fetch
      - fetch-pip-cache:/cache/pip
      - fetch-python-cache:/cache/python
      - fetch-http-cache:/cache/http
    
    optimization:
      http2: true
      network: 1gb-tuned
    
    capabilities:
      - http_get
      - http_post
      - web_scraping

  # ===========================================================================
  # TIER 3: Experimental Python Environment
  # ===========================================================================
  python-experimental:
    service:
      name: python-experimental
      type: experimental
      version: 3.15.0a1
      description: Python 3.15 with free-threaded mode (no GIL)
    
    network:
      ip: 172.20.0.40
    
    resources:
      cpu: 4
      memory: 8g
    
    volumes:
      - python-exp-cache:/cache/python
      - workspace:/workspace
    
    optimization:
      gil_disabled: true
      lto: full
      pgo: enabled
      arch: x86-64-v3
    
    features:
      - free-threading
      - performance-monitoring
      - advanced-profiling

# ==============================================================================
# VOLUME DEFINITIONS
# ==============================================================================
volumes:
  # GitHub MCP
  github-mcp-cache:
    name: github-mcp-cache
  github-mcp-data:
    name: github-mcp-data
  
  # Filesystem MCP
  filesystem-node-cache:
    name: filesystem-node-cache
  workspace:
    name: workspace
  
  # Memory MCP
  memory-data:
    name: memory-data
  memory-node-cache:
    name: memory-node-cache
  memory-cache:
    name: memory-cache
  
  # Git MCP
  git-cache:
    name: git-cache
  git-pip-cache:
    name: git-pip-cache
  git-python-cache:
    name: git-python-cache
  
  # Fetch MCP
  fetch-cache:
    name: fetch-cache
  fetch-pip-cache:
    name: fetch-pip-cache
  fetch-python-cache:
    name: fetch-python-cache
  fetch-http-cache:
    name: fetch-http-cache
  
  # Python Experimental
  python-exp-cache:
    name: python-exp-cache

# ==============================================================================
# NETWORK CONFIGURATION
# ==============================================================================
network:
  name: mcp-cluster
  driver: bridge
  subnet: 172.20.0.0/16
  gateway: 172.20.0.1

# ==============================================================================
# METADATA
# ==============================================================================
metadata:
  description: Model Context Protocol (MCP) Server Infrastructure
  maintainer: Dean Luus
  created: 2025-10-27
  last_updated: 2025-10-27
  version: 1.0.0
  total_servers: 6
  total_volumes: 18
